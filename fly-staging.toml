# Stagingç’°å¢ƒç”¨ Fly.ioè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«
# ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³: timelogger-staging
# ç’°å¢ƒ: Asia/Kolkataï¼ˆé–‹ç™ºè€…å¯¾å¿œï¼‰

app = 'timelogger-staging'
primary_region = 'nrt'
kill_signal = 'SIGINT'
kill_timeout = '5s'

[build]
  # Dockerfileã‚’ä½¿ç”¨ï¼ˆæœ¬ç•ªç’°å¢ƒã¨åŒä¸€ï¼‰

[env]
  NODE_ENV = 'staging'
  TZ = 'Asia/Kolkata'
  PORT = '3000'
  
  # Stagingç’°å¢ƒå›ºæœ‰è¨­å®š
  LOG_LEVEL = 'debug'                    # ãƒ‡ãƒãƒƒã‚°ãƒ¬ãƒ™ãƒ«ãƒ­ã‚°
  ENABLE_DEBUG_ROUTES = 'true'           # ãƒ‡ãƒãƒƒã‚°ç”¨APIæœ‰åŠ¹åŒ–
  API_RATE_LIMIT = 'false'               # ãƒ¬ãƒ¼ãƒˆåˆ¶é™ç„¡åŠ¹åŒ–ï¼ˆãƒ†ã‚¹ãƒˆç”¨ï¼‰
  CACHE_TTL = '60'                       # ã‚­ãƒ£ãƒƒã‚·ãƒ¥TTLçŸ­ç¸®ï¼ˆãƒ†ã‚¹ãƒˆç”¨ï¼‰

# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒœãƒªãƒ¥ãƒ¼ãƒ ï¼ˆæœ¬ç•ªã¨åˆ†é›¢ï¼‰
[[mounts]]
  source = 'timelogger_staging_data'
  destination = '/app/data'

# HTTPã‚µãƒ¼ãƒãƒ¼è¨­å®šï¼ˆã‚³ã‚¹ãƒˆæœ€é©åŒ–ï¼‰
[http_service]
  internal_port = 3000
  force_https = true
  
  # ğŸ’° ã‚³ã‚¹ãƒˆæœ€é©åŒ–è¨­å®š
  auto_stop_machines = true              # æœªä½¿ç”¨æ™‚è‡ªå‹•åœæ­¢
  auto_start_machines = true             # ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ™‚è‡ªå‹•èµ·å‹•
  min_machines_running = 0               # æœ€å°ç¨¼åƒå°æ•°0ï¼ˆé–‹ç™ºæ™‚é–“å¤–ã¯å®Œå…¨åœæ­¢ï¼‰
  
  processes = ["app"]

# ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯è¨­å®š
[[http_service.checks]]
  interval = "30s"
  timeout = "10s"
  grace_period = "5s"
  method = "GET"
  path = "/health"
  protocol = "http"
  tls_skip_verify = false

# ğŸ–¥ï¸ VMè¨­å®šï¼ˆæœ¬ç•ªã‚ˆã‚Šå°ã•ãªãƒªã‚½ãƒ¼ã‚¹ï¼‰
[[vm]]
  cpu_kind = 'shared'                    # å…±æœ‰CPU
  cpus = 1                               # 1CPUï¼ˆæœ¬ç•ªã¨åŒã˜ï¼‰
  memory_mb = 256                        # 256MBï¼ˆæœ¬ç•ªã¨åŒã˜ï¼‰
  count = 1                              # ãƒã‚·ãƒ³1å°

# ğŸ” ãƒ‡ãƒãƒƒã‚°ç”¨è¨­å®šï¼ˆstagingç’°å¢ƒã®ã¿ï¼‰
[console_command]
  command = "/bin/bash"

# ğŸ“Š ãƒ¡ãƒˆãƒªã‚¯ã‚¹ãƒ»ãƒ­ã‚°è¨­å®š
[metrics]
  port = 9091
  path = "/metrics"

# ğŸŒ™ è‡ªå‹•ã‚µã‚¹ãƒšãƒ³ãƒ‰é€£æºè¨­å®š
[experimental]
  auto_rollback = true                   # è‡ªå‹•ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯æœ‰åŠ¹